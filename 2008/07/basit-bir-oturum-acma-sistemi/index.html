<!doctype html>
    <html lang="tr">
      <head>
        <title>Basit Bir Oturum Açma Sistemi - UBenzer</title>
        <base href="/"/>
        <meta content="utf-8" name="charset"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="#2196F3" name="theme-color"/><meta content="CİDDEN ÖNEMLİ NOT: Bu kod parçası güncel haliyle GÜVENLİK AÇIĞI İÇERMEKTEDİR. DEĞİŞİKLİK YAPMADAN KULLANMAYINIZ! Aksi halde sorumluluğun S’sini almayacağımı bizzat belirtirim." name="description"/><meta content="article" property="og:type"/><meta content="106731154350" property="fb:app_id"/><meta content="tr_TR" property="og:locale"/><meta content="https://ubenzer.com/2008/07/basit-bir-oturum-acma-sistemi/" property="og:url"/><meta content="Basit Bir Oturum Açma Sistemi" property="og:title"/><meta content="CİDDEN ÖNEMLİ NOT: Bu kod parçası güncel haliyle GÜVENLİK AÇIĞI İÇERMEKTEDİR. DEĞİŞİKLİK YAPMADAN KULLANMAYINIZ! Aksi halde sorumluluğun S’sini almayacağımı bizzat belirtirim." property="og:description"/>
        <link href="/ui.css" media="screen" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400italic,700italic,700,400&amp;amp;subset=latin-ext" media="screen" rel="stylesheet" type="text/css"/><link href="/img/favicon/apple-touch-icon-57x57.png" rel="apple-touch-icon-precomposed" sizes="57x57"/><link href="/img/favicon/apple-touch-icon-60x60.png" rel="apple-touch-icon-precomposed" sizes="60x60"/><link href="/img/favicon/apple-touch-icon-72x72.png" rel="apple-touch-icon-precomposed" sizes="72x72"/><link href="/img/favicon/apple-touch-icon-76x76.png" rel="apple-touch-icon-precomposed" sizes="76x76"/><link href="/img/favicon/apple-touch-icon-114x114.png" rel="apple-touch-icon-precomposed" sizes="114x114"/><link href="/img/favicon/apple-touch-icon-120x120.png" rel="apple-touch-icon-precomposed" sizes="120x120"/><link href="/img/favicon/apple-touch-icon-152x152.png" rel="apple-touch-icon-precomposed" sizes="152x152"/><link href="/img/favicon/favicon-196x196.png" rel="icon" sizes="196x196"/><link href="/img/favicon/favicon-128x128.png" rel="icon" sizes="128x128"/><link href="/img/favicon/favicon-96x96.png" rel="icon" sizes="96x96"/><link href="/img/favicon/favicon-32x32.png" rel="icon" sizes="32x32"/><link href="/img/favicon/favicon-16x16.png" rel="icon" sizes="16x16"/><link href="https://ubenzer.com/2008/07/basit-bir-oturum-acma-sistemi/" rel="canonical"/>
      </head>
      <body>
        <div><header class="header "><div class="app-bar"><h1 class="app-bar__title app-bar__text"><a class="app-bar__title-link" href="/">UBenzer</a></h1><div class="app-bar__spacer"></div><a class="app-bar__about-link app-bar__text" href="/hakkimda/">Hakkımda</a><div class="app-bar__mobile-menu-container mdc-menu-anchor"><button class="mdc-button app-bar__mobile-button"><img class="app-bar__mobile-button-icon" src="/img/ic_more_vert_white_24px.svg"/></button><div class="mdc-simple-menu app-bar__mobile-menu" style="position:absolute;" tabindex="-1"><ul aria-hidden="true" class="mdc-simple-menu__items mdc-list" role="menu"><li class="mdc-list-item" data-href="/hakkimda/" role="menuitem" tabindex="0">Hakkımda</li></ul></div></div></div></header><div class="main-container"><div class="main-container__main-content"><article class="card main-container__items"><div class="card__contents blog-post"><div class="blog-post__date">11 Temmuz 2008</div><h1 class="blog-post__title"><a href="/2008/07/basit-bir-oturum-acma-sistemi/">Basit Bir Oturum Açma Sistemi</a></h1><div class="markdown-content blog-post__body blog-post__content"><blockquote>
<p><em>CİDDEN ÖNEMLİ NOT:</em> Bu kod parçası güncel haliyle GÜVENLİK AÇIĞI İÇERMEKTEDİR. DEĞİŞİKLİK YAPMADAN KULLANMAYINIZ! Aksi halde sorumluluğun S’sini almayacağımı bizzat belirtirim.</p>
</blockquote>
<p>Birkaç gün önce hem <em>PHP Session</em>’ların ne olduğunu ve nasıl kullanıldığını öğrenmek, hem <a href="http://www.yakuter.com/ezsql-veritabani-sinifinin-kullanimi/" rel="noopener noreferrer" target="_blank">yakuter’in anlattığı</a> <a href="http://justinvincent.com/ezsql" rel="noopener noreferrer" target="_blank">ezSQL</a> sınıflarının nasıl kullanıldığını öğrenmek, hem de belki ileride bir projede kullanırım kalsın bir köşede dediğim için gerçekten çok basit bir oturum açma sistemi yazdım.</p>
<p>Sistem, girilen kullanıcı adı ve şifreyi veritabanında arıyor, eğer doğruysa oturum açıyor. Oturumun açık olup olmadığı proje esnasında is_logged() isimli fonksiyon ile kolaylıkla kontrol edilebiliyor.</p>
<p>Projede oturum açılıp açılmadığı kullanıcının tarayıcısına yazılan bir çerez (cookie) yerine, sunucu bazlı sessionlar tarafından belirleniyor. Bu da cookie desteklemeyen tarayıcılarda bile sorun yaratmamasını sağlayacaktır.</p>
<p>Proje Dosyaları</p>
<blockquote>
<p><em>index.php</em> Başlangıç işlerini yapar. Kullanıcı hangi sayfayı istiyor olursa olsun bu sayfadan geçmek zorundadır.</p>
</blockquote>
<pre><code class="hljs language-php"> <span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">/* Projenin diğer dosyaları doğrudan çağrılınca çalışmamaları için */</span> <span class="hljs-comment">/* Other php's of project shouldn't call directly. */</span> define(<span class="hljs-string">'DUYURU'</span>,<span class="hljs-number">1</span>);

<span class="hljs-comment">/* Session */</span> session_start(); header(<span class="hljs-string">'Content-Type: text/html; charset=utf-8'</span>);

<span class="hljs-comment">/* Veritabanı ve Fonksiyonlar*/</span> <span class="hljs-comment">/* Database and Functions */</span> <span class="hljs-keyword">require_once</span>(<span class="hljs-string">"./db/settings.php"</span>); <span class="hljs-comment">/* Genel ve veritabanı ayarlarını tutar. General and database connection settings. */</span> <span class="hljs-keyword">require_once</span>(<span class="hljs-string">"functions.php"</span>); <span class="hljs-comment">/* Projenin gerekli fonksiyonlarını içerir. Functions needed by this project. */</span>

<span class="hljs-comment">/* Post-Get İşleyici: Eğer sayfaya get ya da post verileriyle gelinirse gerekli fonksiyonlara yönlendirme yapılır. */</span> <span class="hljs-comment">/* Post-Get Processor: If user sent data includes POST or GET data, then user redirects to proper function. */</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'action'</span>])) { <span class="hljs-keyword">switch</span> ($_GET[<span class="hljs-string">'action'</span>]) { <span class="hljs-keyword">case</span> <span class="hljs-string">'logout'</span>: logout(); <span class="hljs-keyword">break</span>; <span class="hljs-keyword">case</span> <span class="hljs-string">'login'</span>: login(); <span class="hljs-keyword">break</span>; } } <span class="hljs-comment">/* Post-Get İşleyici Bitti*/</span> <span class="hljs-comment">/* End of Post-Get Processor */</span>

<span class="hljs-comment">/* Çıktı Başlangıcı */</span> <span class="hljs-comment">/* Projenin bu adımından sonra istediğiniz çıktıyı alabilrisiniz. Oturum açılıp açılmadığını projinizin herhangi bir noktasında is_logged() fonksiyonu ile yapabilirsiniz. is_logged: Eğer oturum açıldıysa 1, oturum açılmadıysa 0 döndürür. Örnek kod aşağıdadır. */</span>

<span class="hljs-comment">/* Start of Output */</span> <span class="hljs-comment">/* At this stage of project. You can output whatevet you want. If you want to check if user logged in or not, just use is_logged() function. is_logged: If user logged returns 1, else returns 0\. Sample code is bellow. */</span>

<span class="hljs-keyword">if</span> (!is_logged()) { <span class="hljs-meta">?&gt;</span> &lt;form name=<span class="hljs-string">"loginform"</span> id=<span class="hljs-string">"loginform"</span> action=<span class="hljs-string">"index.php?action=login"</span> method=<span class="hljs-string">"post"</span>&gt; &lt;p&gt; &lt;label&gt;Kullanıcı adı&lt;br /&gt; &lt;input type=<span class="hljs-string">"text"</span> name=<span class="hljs-string">"user"</span> id=<span class="hljs-string">"user"</span> <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">input</span>" <span class="hljs-title">value</span>="" <span class="hljs-title">size</span>="20" <span class="hljs-title">tabindex</span>="10" /&gt;&lt;/<span class="hljs-title">label</span>&gt; &lt;/<span class="hljs-title">p</span>&gt; &lt;<span class="hljs-title">p</span>&gt; &lt;<span class="hljs-title">label</span>&gt;Ş<span class="hljs-title">ifre</span>&lt;<span class="hljs-title">br</span> /&gt; &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>="<span class="hljs-title">password</span>" <span class="hljs-title">name</span>="<span class="hljs-title">pass</span>" <span class="hljs-title">id</span>="<span class="hljs-title">pass</span>" <span class="hljs-title">class</span>="<span class="hljs-title">input</span>" <span class="hljs-title">value</span>="" <span class="hljs-title">size</span>="20" <span class="hljs-title">tabindex</span>="20" /&gt;&lt;/<span class="hljs-title">label</span>&gt; &lt;/<span class="hljs-title">p</span>&gt; &lt;<span class="hljs-title">input</span> <span class="hljs-title">name</span>="<span class="hljs-title">key</span>" <span class="hljs-title">type</span>="<span class="hljs-title">hidden</span>" <span class="hljs-title">value</span>="&lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span>(<span class="hljs-title">md5</span>(<span class="hljs-title">session_id</span>())); ?&gt;"/&gt; &lt;<span class="hljs-title">p</span> <span class="hljs-title">class</span>="<span class="hljs-title">submit</span>"&gt; &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>="<span class="hljs-title">submit</span>" <span class="hljs-title">id</span>="<span class="hljs-title">wp</span>-<span class="hljs-title">submit</span>" <span class="hljs-title">value</span>="<span class="hljs-title">Giri</span>ş" <span class="hljs-title">tabindex</span>="100" /&gt; &lt;/<span class="hljs-title">p</span>&gt; &lt;/<span class="hljs-title">form</span>&gt; &lt;?<span class="hljs-title">php</span> } <span class="hljs-title">else</span> </span>{ <span class="hljs-meta">?&gt;</span> Tebrikler oturum açtın. Şimdi &lt;a href=<span class="hljs-string">"index.php?action=logout"</span>&gt;kapat&lt;/a&gt;. :) <span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span>
</code></pre>
<blockquote>
<p><em>functions.php</em> Proje tarafından gerekli fonksiyonları içerir.</p>
</blockquote>
<pre><code class="hljs language-php"> <span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">if</span> (!defined(<span class="hljs-string">'DUYURU'</span>)) { <span class="hljs-comment">/* You can't reach this page directly. */</span> <span class="hljs-comment">/* Bu sayfaya doğrudan erişilemez. */</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">'Yok artık Lebron James!'</span>); }

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_logged</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* Return values: 1 = LOGGED; 0 = GUEST */</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_SESSION[<span class="hljs-string">'logged'</span>])) { <span class="hljs-keyword">return</span> $_SESSION[<span class="hljs-string">'logged'</span>]; } <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; } }

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* Zaten açık oturumu bir daha açamayız. */</span> <span class="hljs-comment">/* Can't login, if person already logged in. */</span> <span class="hljs-keyword">if</span> (!$_SESSION[<span class="hljs-string">'logged'</span>] == <span class="hljs-number">1</span>) { <span class="hljs-comment">/* Input values; $_POST['user'] = user_name $_POST['pass'] = password $_POST['key'] = session in md5 */</span> <span class="hljs-comment">/* Return values: 1: Login OK, $_SESSION['logged'] = 1; -1: Login Failed. */</span> <span class="hljs-keyword">global</span> $db, $prefix, $mesaj; <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'user'</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'pass'</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'key'</span>]))) { $mesaj = <span class="hljs-string">'invalid_data'</span>; <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; } $session = htmlspecialchars($_POST[<span class="hljs-string">'key'</span>]); $user = htmlspecialchars($_POST[<span class="hljs-string">'user'</span>]); $pass = htmlspecialchars($_POST[<span class="hljs-string">'pass'</span>]); <span class="hljs-keyword">if</span> (htmlspecialchars(md5(session_id())) != $session) { $mesaj = <span class="hljs-string">'session_invalid'</span>; <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; } <span class="hljs-keyword">if</span> ($user == <span class="hljs-keyword">NULL</span> || $user == <span class="hljs-string">""</span> || $pass == <span class="hljs-keyword">NULL</span> || $pass == <span class="hljs-string">""</span>) { $mesaj = <span class="hljs-string">'invalid_data'</span>; <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; } $sonuc = $db-&gt;get_row(<span class="hljs-string">'SELECT pass FROM '</span>.$prefix.<span class="hljs-string">'user WHERE name = "'</span>.$user.<span class="hljs-string">'"'</span>); <span class="hljs-keyword">if</span> (md5($pass) == $sonuc-&gt;pass &amp;&amp; $_SESSION[<span class="hljs-string">'logged'</span>] != <span class="hljs-number">1</span>) { $sonuc = $db-&gt;get_row(<span class="hljs-string">'SELECT ID, name, real_name, login_count FROM '</span>.$prefix.<span class="hljs-string">'user WHERE name = "'</span>.$user.<span class="hljs-string">'"'</span>); $_SESSION[<span class="hljs-string">'name'</span>] = $sonuc-&gt;name; $_SESSION[<span class="hljs-string">'real_name'</span>] = $sonuc-&gt;real_name; $_SESSION[<span class="hljs-string">'ID'</span>] = $sonuc-&gt;ID; $db-&gt;query(<span class="hljs-string">'UPDATE '</span>.$prefix.<span class="hljs-string">'user SET login_count = "'</span>.++$sonuc-&gt;login_count.<span class="hljs-string">'" WHERE ID = "'</span>.$_SESSION[<span class="hljs-string">'ID'</span>].<span class="hljs-string">'"'</span>); $db-&gt;query(<span class="hljs-string">'UPDATE '</span>.$prefix.<span class="hljs-string">'user SET last_login = NOW() WHERE ID = "'</span>.$_SESSION[<span class="hljs-string">'ID'</span>].<span class="hljs-string">'"'</span>);

$_SESSION[<span class="hljs-string">'logged'</span>] = <span class="hljs-number">1</span>; header(<span class="hljs-string">'Location: index.php'</span>); <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; }

$mesaj = <span class="hljs-string">'invalid_data'</span>; <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; } }

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logout</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* Açık olmayan oturumun nesini sonlandıracağım! */</span> <span class="hljs-comment">/* Can't logoff, if person is not login. */</span> <span class="hljs-keyword">if</span> ($_SESSION[<span class="hljs-string">'logged'</span>] == <span class="hljs-number">1</span>) { <span class="hljs-keyword">global</span> $mesaj; $_SESSION[<span class="hljs-string">'logged'</span>] = <span class="hljs-number">0</span>; $mesaj = <span class="hljs-string">'logged_out'</span>; } } <span class="hljs-meta">?&gt;</span>
</code></pre>
<blockquote>
<p><em>db/settings.php</em> Veritabanı bağlantı ayarlarını içerir. ezSQL ile bağlantı kurar.</p>
</blockquote>
<pre><code class="hljs language-php"> <span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">if</span> (!defined(<span class="hljs-string">'DUYURU'</span>)) { <span class="hljs-comment">/* You can't reach this page directly. */</span> <span class="hljs-comment">/* Bu sayfaya doğrudan erişilemez. */</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">'Yasak. :)'</span>); }

<span class="hljs-comment">/* ez_SQL sınıfları çağırılır. */</span> <span class="hljs-comment">/* ez_SQL classes */</span> <span class="hljs-keyword">include</span> (<span class="hljs-string">"./db/core.php"</span>); <span class="hljs-keyword">include</span> (<span class="hljs-string">"./db/mysql.php"</span>);

<span class="hljs-comment">/* Sunucu Ayarları */</span> $db_server = <span class="hljs-string">'localhost'</span>; $db_name = <span class="hljs-string">'veritabanı_adı'</span>; $db_user = <span class="hljs-string">'veritabanı_kullanıcısı'</span>; $db_passwd = <span class="hljs-string">'veritabanı_şiresi'</span>; $prefix = <span class="hljs-string">"log_"</span>; <span class="hljs-comment">/* Veritaanı öneki. */</span> $version = <span class="hljs-number">0.1</span>; <span class="hljs-comment">/* Proje sürümü - Project version */</span>

$db = <span class="hljs-keyword">new</span> ezSQL_mysql($db_user,$db_passwd,$db_name,$db_server);

<span class="hljs-comment">/* GEREKLİ VERİTABANI TABLOSU YAPISI - REQUIRED DATABASE TABLE STRUCTURE */</span>

<span class="hljs-comment">/* CREATE TABLE IF NOT EXISTS `log_user` ( `ID` int(11) NOT NULL auto_increment, `name` text NOT NULL, `pass` text NOT NULL, `real_name` text NOT NULL, `last_login` datetime NOT NULL default '0000-00-00 00:00:00', `login_count` int(11) NOT NULL default '0', PRIMARY KEY (`ID`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;

INSERT INTO `yse_user` (`ID`, `name`, `pass`, `real_name`, `last_login`, `login_count`) VALUES (1, 'Umut', '202cb962ac59075b964b07152d234b70', 'Umut Benzer', '2008-07-09 01:56:10', 0);

*/</span>

<span class="hljs-comment">/* Bu tablo ile kullanıcı adı Umut şifre 123 olan bir test kullanıcısı yaratılır. */</span> <span class="hljs-comment">/* With this table a test user created with username Umut pass 123 */</span>

<span class="hljs-meta">?&gt;</span>
``` Projenin tüm dosyalarını (ve ezSQL sınıflarını) [buradan indirebilirsiniz](loginout.zip). Dosya, veritabanı tablosunu yaratmak için gerekli SQL satırlarını da içerir.

*Sistem Gereksinimleri:* PHP <span class="hljs-number">4</span>+, MySQL
</code></pre>
</div></div></article><div class="card comments main-container__items"><div class="card__contents" id="disqus_thread"></div></div></div><div class="sidebar main-container__sidebar"><div class="about"><img class="about__image round-img" src="img/profile.jpg"/><h1 class="about__name">Umut Benzer</h1><h2 class="about__mini-bio">Software Engineer, MSc. in Berlin</h2></div></div></div><div class="main-container"><div class="footer"><div class="footer__copyright-holder"><p><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" rel="license noopener noreferrer" target="_blank"><img alt="Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License" src="/img/cclicense.png"/></a></p><p><span>Bu sitedeki tüm yazı ve görseller </span><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" rel="license noopener noreferrer" target="_blank">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a><span> ile lisanslanmıştır.</span></p></div><div class="footer__generator"><span>Bu sayfa </span><span>31 Ağustos 2017</span><span> tarihinde </span><a href="https://github.com/ubenzer/fil" target="_blank">Fil</a><span> ile yaratılmıştır.</span></div></div></div></div>
        <script src="/app.js" type="text/javascript"></script><script type="text/javascript">
        var disqus_config = function () {
          this.page.url = "https://ubenzer.com/2008/07/basit-bir-oturum-acma-sistemi/";
        };
        (function() {
          var d = document, s = d.createElement('script');
          s.src = 'https://ubenzer.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
        </script><script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-509698-8', 'auto');
      ga('send', 'pageview');
      </script>
      </body>
    </html>
  