<!doctype html>
    <html lang="tr">
      <head>
        <title>Bant Genişliği Hırsızlarına Hotlink Koruması - UBenzer</title>
        <meta content="utf-8" name="charset"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="#2196F3" name="theme-color"/><meta content="Wikipedia der ki:" name="description"/><meta content="article" property="og:type"/><meta content="106731154350" property="fb:app_id"/><meta content="tr_TR" property="og:locale"/><meta content="https://ubenzer.com/2009/07/bant-genisligi-hirsizlarina-hotlink-korumasi/" property="og:url"/><meta content="Bant Genişliği Hırsızlarına Hotlink Koruması" property="og:title"/><meta content="Wikipedia der ki:" property="og:description"/>
        <link href="/ui.css" media="screen" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400italic,700italic,700,400&amp;amp;subset=latin-ext" media="screen" rel="stylesheet" type="text/css"/><link href="/img/favicon/apple-touch-icon-57x57.png" rel="apple-touch-icon-precomposed" sizes="57x57"/><link href="/img/favicon/apple-touch-icon-60x60.png" rel="apple-touch-icon-precomposed" sizes="60x60"/><link href="/img/favicon/apple-touch-icon-72x72.png" rel="apple-touch-icon-precomposed" sizes="72x72"/><link href="/img/favicon/apple-touch-icon-76x76.png" rel="apple-touch-icon-precomposed" sizes="76x76"/><link href="/img/favicon/apple-touch-icon-114x114.png" rel="apple-touch-icon-precomposed" sizes="114x114"/><link href="/img/favicon/apple-touch-icon-120x120.png" rel="apple-touch-icon-precomposed" sizes="120x120"/><link href="/img/favicon/apple-touch-icon-152x152.png" rel="apple-touch-icon-precomposed" sizes="152x152"/><link href="/img/favicon/favicon-196x196.png" rel="icon" sizes="196x196"/><link href="/img/favicon/favicon-128x128.png" rel="icon" sizes="128x128"/><link href="/img/favicon/favicon-96x96.png" rel="icon" sizes="96x96"/><link href="/img/favicon/favicon-32x32.png" rel="icon" sizes="32x32"/><link href="/img/favicon/favicon-16x16.png" rel="icon" sizes="16x16"/><link href="https://ubenzer.com/2009/07/bant-genisligi-hirsizlarina-hotlink-korumasi/" rel="canonical"/>
      </head>
      <body>
        <div><header class="header "><div class="app-bar"><h1 class="app-bar__title"><a class="app-bar__title-link" href="/">UBenzer</a></h1></div></header><div class="main-container"><div class="main-container__main-content"><article class="card main-container__items"><div class="card__contents blog-post"><div class="blog-post__date">19 Temmuz 2009</div><h1 class="blog-post__title"><a href="/2009/07/bant-genisligi-hirsizlarina-hotlink-korumasi/">Bant Genişliği Hırsızlarına Hotlink Koruması</a></h1><div class="markdown-content blog-post__body blog-post__content"><p><a href="http://en.wikipedia.org/wiki/Hotlink" rel="noopener noreferrer" target="_blank">Wikipedia</a> der ki:</p>
<blockquote>
<p>Inline linking <em>(also known as hotlinking, leeching, piggy-backing, direct linking, offsite image grabs and bandwidth theft)</em> is the use of a linked object, often an image, from one site into a web page belonging to a second site. The second site is said to have an inline link to the site where the object is located.</p>
</blockquote>
<p>Kısa ve Öz Meali:</p>
<blockquote>
<p>Hotlinking, bir sitenin başka bir sitenin <em>(genelde resim dosyası olan)</em> içeriğini izinsiz kullanması <em>(bant genişliği hırsızlığı yapması)</em> anlamına gelir.</p>
</blockquote>
<p>Basit bir örnek verecek olursak: Siz web sitenize bir fotoğraf (mesela Türk bayrağı) yüklersiniz. Bu fotoğrafın adresi (siteniz.com/resim.jpg) olur. Başka bir X sitesi de, içeriğine Türk bayrağı eklemek ister. Ancak sizin fotoğrafınızın bir kopyasını kendi sunusuna atmak yerine aşağıdaki kodu kullanarak, doğrudan sizin sununuzdan çeker:</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- ADAMIN SİTESİNİN ADRESİNİN hirsiz.com OLDUĞUNU VARSAYARSAK --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://www.ubenzer.com/deepo/hotlink/hotlink.png"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Bayrak"</span> /&gt;</span>
</code></pre>
<h3>Bunun size zararı nedir?</h3>
<p>Bandwidth <em>(ya da bant genişliği, BW)</em>, web sitenizin yayınlanması için anlaşma yaptığınız şirketin size <em>(genelde)</em> bir aylık süre zarfı içerisinde yapabileceğiniz en çok veri aktarım boyutu için koyduğu sınırdır. Sözgelimi, sizin bant genişliğiniz 500MB olsun. Web sitenizin her sayfasının 0.1MB (100KB) olduğunu varsayarsak, bir ayda en fazla 50000 sayfa görüntülenebilir. Daha sonra siteniz ay bitene kadar kapalı kalacaktır.</p>
<p>Başka birinin sizin alanınızdaki bir dosyayı sömürmesi de size bu noktada zararlıdır. Adam sizin kendi sunucunuza attığınız karikatürleri bir foruma gönderiyor olabilir. Forumda bu resimlerin her yüklenişi size BW gideri olarak patlayacaktır... <em>Biraz acemiyseniz bundan haberiniz bile olmayabilir.</em></p>
<h3>Hırsızlığı nasıl tespit ederiz?</h3>
<p>HTTP protokülünde referans <em>(referrer)</em> denilen bir olay vardır. Basitçe özetlersek, HTTP protokolü ile bir istek yapıldığında, istekle beraber bir referans gönderilebilir. Referans &quot;içinde bulunulan son sayfa&quot; olarak açıklanabilir. Örneğin Facebook'ta paylaşılan bir bağlantınıza birisi tıkladığında <em>HTTP Referrer kullanıcının Facebook'ta o anda bulunduğu sayfanın tam adresi olacaktır.</em> Bir HTML belgesinin içindeki bir resim (img tagı) yüklenecekse, tarayıcı referrer olarak sayfanın adresini gönderecektir.</p>
<p><em>HTTP Referrer tarayıcıya bağlıdır</em> ve çeşitli eklentilerle <em>gönderilmemesi sağlanabilir</em>. Eğer <em>bir sitenin adresini adres çubuğuna elle yazarak girerseniz</em> de HTTP referans bilgisi göndermemiş olursunuz.</p>
<p>Bir dosya, <em>sizin içeriğinizi ve bant genişliğinizi sömüren sitede</em> açılmaya çalışıldığında <em>referans olarak bu sitenin adresi gelecektir. Böylece hırsızlığı tespit edebilirsiniz.</em></p>
<h3>Nasıl çözülür?</h3>
<p>HTTP Referrer bilgisini kontrol edebileceğiniz her yolla. Ama en basiti (linux ortamında) <em>.htaccess</em> dosyası ile. Sitenizin kök klasörüne aşağıdaki bilgileri içeren bir <em>.htaccess</em> dosyası oluşturursanız <em>JPG, JPEG, PNG, GIF ve BMP</em> formatındaki dış referanslar sizin istediğiniz bir dosyaya yönlenecektir.</p>
<p>Bu kod parçası <em>mod_rewrite</em>'nin açık olmasını gerektirmektedir ki, açık değilse ve siz o hosting firmasını seçtiyseniz kendinizi camdan atabilirsiniz. Yok eğer sunucunun sahibi benim diyorsanız <em>httpd.conf</em> dosyasında gerekli oynamaları yapıp sunucuyu yeniden başlatmalısınız.</p>
<pre><code class="hljs"><span class="hljs-comment"># BEGIN Hotlink Koruması</span>

<span class="hljs-section">&lt;IfModule mod_rewrite.c&gt;</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span> <span class="hljs-literal">on</span>

<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{REQUEST_URI}</span> ^/deepo/hotlink
<span class="hljs-comment"># Hotlink resimlerinin olduğu dizini korumasız yapmalıyız ki, sonsuz dönüye girmeyelim.</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> ^.*$ -<span class="hljs-meta"> [L]</span>

<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{HTTP_REFERER}</span> !^$
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{HTTP_REFERER}</span> !^http://(.+\.)?ubenzer\.com<span class="hljs-meta"> [NC]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{HTTP_REFERER}</span> !^http://(.+\.)?facebook\.com<span class="hljs-meta"> [NC]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{HTTP_REFERER}</span> !^https://(.+\.)?facebook\.com<span class="hljs-meta"> [NC]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{HTTP_REFERER}</span> !^http://(.+\.)?google\.com<span class="hljs-meta"> [NC]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{HTTP_REFERER}</span> !^http://(.+\.)?google\.com\.tr<span class="hljs-meta"> [NC]</span>

<span class="hljs-comment"># Yukarıdaki sitelerden biri referans olarak gelirse engelleme mekanizması çalışmaz. Kendi sitemizi</span>
<span class="hljs-comment"># bu alana eklemek ÖNEMLİDİR! Yoksa kendi sitemize de hırsız muamelesi uygularız.</span>
<span class="hljs-comment"># Facebook ve Google tarzı sitelerde de ön izlemelerin çalışması için yine mekanizmayı çalıştırmamak iyidir.</span>

<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> .*\.(jpg|jpeg|gif|png|bmp|JPG|JPEG|GIF|PNG|BMP)$ http://www.ubenzer.com/deepo/hotlink/hotlink.<span class="hljs-number">$1</span><span class="hljs-meta"> [L]</span>
<span class="hljs-comment"># Her formatı ayrı ayrı ele almak gerekir. Hırsız PNG istediğinde siz JPG biçimi gönderirseniz her tarayıcı bunu doğru yorumlayamaz.</span>
<span class="hljs-section">&lt;/IfModule&gt;</span>

<span class="hljs-comment"># END Hotlink Koruması</span>
</code></pre>
<h3>Dosya iyi hoş da, bir anlatıversen?</h3>
<p>Anlatalım efendim.</p>
<p>Öncelikle <em>hırsızların istediği resim yerine görünecek resimlerimizi</em> hazırlayarak <em>jpg, gif, png ve bmp</em> formatlarında kaydediyoruz. Daha sonra büyük-küçük harf sorunlarını engellemek için uzantıların büyük harflilerini de kaydediyoruz. <em>(Linux sistemlerde a.JPG ile a.jpg farklı dosya olarak kabul edilir.)</em> Kısaca aşağıdaki dosyaları hazırlıyoruz:</p>
<ul>
<li>hotlink.GIF</li>
<li>hotlink.gif</li>
<li>hotlink.JPG</li>
<li>hotlink.jpg</li>
<li>hotlink.JPEG</li>
<li>hotlink.jpeg</li>
<li>hotlink.BMP</li>
<li>hotlink.bmp</li>
<li>hotlink.PNG</li>
<li>hotlink.png</li>
</ul>
<p>Eğer ilham gelmiyorsa, benim <a href="/2009/07/bant-genisligi-hirsizlarina-hotlink-korumasi/hotlink.png" >hotlink resmimden ilham alabilirsiniz</a>.</p>
<p>İkinci adımda sitenizde <em>&quot;hotlink korumasız&quot;</em> bir dizin oluşturmalısınız. Hotlink durumunda görünecek resimleri de hotlink korumasına maruz bırakırsanız insanlık sizi affetmez. Benim örneğimde bu dizin www.ubenzer.com/deepo/hotlink/. Kendi <em>.htaccess</em> dosyanızı <em>bunu ele alarak değiştirin</em>.</p>
<p>Üçüncü adım olarak <em>hotlink korumasından etkilenmeyecek siteleri</em> ayarlamalısınız. <em>Kendi sitenizi mutlaka yazın, yoksa kendi kendinize hırsız muamelesi yaparsınız.</em> Verdiğim örnek <em>.htaccess</em> dosyası tüm subdomain ve adresleri kapsayacak örneklerdir. Mesela <em>facebook.com</em> adresini beyaz listeye alırsanız <em>static.ak.facebook.com</em> da alınır.</p>
<p>Google ve Facebook gibi, <em>ön izlemenin önemli olabileceği siteleri beyaz listeye almanızı</em> ve</p>
<pre><code class="hljs"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{HTTP_REFERER}</span> !^$
</code></pre>
<p>satırını kullanmanızı tavsiye ederim. <em>Bu satır hiçbir referans olmadığında</em> <em>(yani adres satırına doğrudan girildiğinde ya da sık kullanılanlardan çağrıldığında)</em> <em>ilgili resmin görünmesini sağlayacaktır.</em> <em>(Aşırı koruyucu olmamak lazım bir yerde...)</em></p>
<p>Son adımda, yaptıklarınızın keyfini çıkarmak kalıyor size. Bitti bu kadardı. 😃 Hırsızlardan artakalan bant genişliğinizi güle güle kullanın.</p>
<p><em>Güncelleme:</em> <em>.htaccess</em> kodlarındaki ufak bir hatayı giderdim. Yorumuyla beni uyarak Selim'e teşekkürlerimi sunarım.</p>
</div></div></article><div class="card comments main-container__items"><div class="card__contents" id="disqus_thread"></div></div></div><div class="sidebar main-container__sidebar"><div class="about"><img class="about__image round-img" src="/img/profile.jpg"/><h1 class="about__name">Umut Benzer</h1><h2 class="about__mini-bio">Software Engineer, MSc. in Berlin</h2></div></div></div><div class="main-container"><div class="footer"><div class="footer__copyright-holder"><p><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" rel="license noopener noreferrer" target="_blank"><img alt="Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License" src="/img/cclicense.png"/></a></p><p><span>Bu sitedeki tüm yazı ve görseller </span><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" rel="license noopener noreferrer" target="_blank">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a><span> ile lisanslanmıştır.</span></p></div><div class="footer__generator"><span>Bu sayfa </span><span>7 Mayıs 2017</span><span> tarihinde </span><a href="https://github.com/ubenzer/fil" target="_blank">Fil</a><span> ile yaratılmıştır.</span></div></div></div></div>
        <script src="/app.js" type="text/javascript"></script><script type="text/javascript">
        var disqus_config = function () {
          this.page.url = "https://ubenzer.com/2009/07/bant-genisligi-hirsizlarina-hotlink-korumasi/";
          this.page.identifier = "post@/2009/07/bant-genisligi-hirsizlarina-hotlink-korumasi";
        };
        (function() {
          var d = document, s = d.createElement('script');
          s.src = 'https://ubenzer.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
        </script><script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-509698-8', 'auto');
      ga('send', 'pageview');
      </script>
      </body>
    </html>
  